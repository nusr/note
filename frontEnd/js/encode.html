<!DOCTYPE html >
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>将js程序转码为日本表情</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
        }

        body {
            width: 60%;
            margin: 20px auto;

        }
    </style>
</head>

<body>
    <div>
        <div>将js程序转码为日本表情</div>
        <textarea style="width:100%;height:5em" id="javaScriptExpression" onkeyup="javascript:keyup( false )" cols="" rows="">
alert("是不是傻")</textarea>
    </div>
    <div style="text-align:right">
        <input type="button" value="转码" onclick="javascript:keyup( true )" />
        <a href="" id="runCode">运行</a>
    </div>
    <div>
        <textarea style="width:100%;height:40em;line-height:1.5;" id="encodeResult" rows="20" cols="20"></textarea>
    </div>
    <script>
        function encode(text) {
            var t;
            var b = [
                "(c^_^o)",
                "(ﾟΘﾟ)",
                "((o^_^o) - (ﾟΘﾟ))",
                "(o^_^o)",
                "(ﾟｰﾟ)",
                "((ﾟｰﾟ) + (ﾟΘﾟ))",
                "((o^_^o) +(o^_^o))",
                "((ﾟｰﾟ) + (o^_^o))",
                "((ﾟｰﾟ) + (ﾟｰﾟ))",
                "((ﾟｰﾟ) + (ﾟｰﾟ) + (ﾟΘﾟ))",
                "(ﾟДﾟ) .ﾟωﾟﾉ",
                "(ﾟДﾟ) .ﾟΘﾟﾉ",
                "(ﾟДﾟ) ['c']",
                "(ﾟДﾟ) .ﾟｰﾟﾉ",
                "(ﾟДﾟ) .ﾟДﾟﾉ",
                "(ﾟДﾟ) [ﾟΘﾟ]"
            ];
            var r = "ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ ['_']; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); ";

            if (/ひだまりスケッチ×(365|３５６)\s*来週も見てくださいね[!！]/.test(text)) {
                r += "X=_=3; ";
                r += "\r\n\r\n    X / _ / X < \"来週も見てくださいね!\";\r\n\r\n";
            }
            r += "(ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);" +
                "(ﾟДﾟ)={ﾟΘﾟ: '_' ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +'_') [ﾟΘﾟ] " +
                ",ﾟｰﾟﾉ :(ﾟωﾟﾉ+ '_')[o^_^o -(ﾟΘﾟ)] " +
                ",ﾟДﾟﾉ:((ﾟｰﾟ==3) +'_')[ﾟｰﾟ] }; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +'_') [c^_^o];" +
                "(ﾟДﾟ) ['c'] = ((ﾟДﾟ)+'_') [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];" +
                "(ﾟДﾟ) ['o'] = ((ﾟДﾟ)+'_') [ﾟΘﾟ];" +
                "(ﾟoﾟ)=(ﾟДﾟ) ['c']+(ﾟДﾟ) ['o']+(ﾟωﾟﾉ +'_')[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +'_') [ﾟｰﾟ] + " +
                "((ﾟДﾟ) +'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+" +
                "((ﾟｰﾟ==3) +'_') [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) ['c']+" +
                "((ﾟДﾟ)+'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) ['o']+" +
                "((ﾟｰﾟ==3) +'_') [ﾟΘﾟ];(ﾟДﾟ) ['_'] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];" +
                "(ﾟεﾟ)=((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+" +
                "((ﾟДﾟ)+'_') [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +'_') [o^_^o -ﾟΘﾟ]+" +
                "((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟωﾟﾉ +'_') [ﾟΘﾟ]; " +
                "(ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]='\\\\'; " +
                "(ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];" +
                "(oﾟｰﾟo)=(ﾟωﾟﾉ +'_')[c^_^o];" +//TODO
                "(ﾟДﾟ) [ﾟoﾟ]='\\\"';" +
                "(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (ﾟεﾟ+";
            r += "(ﾟДﾟ)[ﾟoﾟ]+ ";
            for (var i = 0; i < text.length; i++) {
                n = text.charCodeAt(i);
                t = "(ﾟДﾟ)[ﾟεﾟ]+";
                if (n <= 127) {
                    t += n.toString(8).replace(/[0-7]/g, function (c) { return b[c] + "+ "; });
                } else {
                    var m = /[0-9a-f]{4}$/.exec("000" + n.toString(16))[0];
                    t += "(oﾟｰﾟo)+ " + m.replace(/[0-9a-f]/gi, function (c) { return b[parseInt(c, 16)] + "+ "; });
                }
                r += t;

            }
            r += "(ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) ('_');";
            return r;
        }
        var _prev;
        function keyup(force) {
            var t = document.getElementById("javaScriptExpression").value;
            var d;
            if (_prev != (t) || force) {
                d = encode(t);
                document.getElementById("encodeResult").value = d;
                _prev = t;
                document.getElementById("runCode").setAttribute("href", "javascript:" + d);
            }
        }

        function init() {
            keyup(true);
            document.getElementById('javaScriptExpression').focus();
        }
        window.onload = function () {
            init()
        }
    </script>
</body>

</html>